/*
 * Timer0_Program.c
 *
 * Created: 4/12/2023 4:16:01 PM
 *  Author: Mahmoud Emad
 */ 
#include "../../../Common/STD_TYPES.h"
#include "Timer0_Register.h"
#include "Timer0_Private.h"
#include "Timer0_configeration.h"
#include "Timer0_Interface.h"

void Timer0_VoidTimer0SettingAdjust()
{
/************************************************ init to normal mode***************************************************/
	#if mood_of_operation==Normal
	TCCR0_ITI &=~ (1<<WGM00_ITI);
	TCCR0_ITI &=~ (1<<WGM01_ITI);
	TCNT0_ITI=preload;
/***********************************************************************************************************************/	

/******************************************* init to Phase correct mode*************************************************/
	#elif mood_of_operation==PhaseCorrect
	
	TCCR0_ITI |= (1<<WGM00_ITI);
	TCCR0_ITI &=~ (1<<WGM01_ITI);
/***********************************************************************************************************************/

/*************************************************** init to CTC mode***************************************************/
	#elif mood_of_operation==CTC
	
	TCCR0_ITI |=  (1<<FOC0_ITI);//force compare output mode 
	TCCR0_ITI &=~ (1<<WGM00_ITI);
	TCCR0_ITI |=  (1<<WGM01_ITI);
	OCR0_ITI= ComapreValue;
				/******************************select what happen on pin oc0*******************************/

	#if  mode_of_CTC== Normal
	
	TCCR0_ITI &=~ (1<<COM00_ITI);
	TCCR0_ITI &=~ (1<<COM01_ITI);
/***********************************************************************************************************************/	
	
	#elif mode_of_CTC== Toggle
	
	TCCR0_ITI |=  (1<<COM00_ITI);
	TCCR0_ITI &=~ (1<<COM01_ITI);
/***********************************************************************************************************************/
		
	#elif mode_of_CTC== Clr
	
	TCCR0_ITI &=~ (1<<COM00_ITI);
	TCCR0_ITI |=  (1<<COM01_ITI);
/***********************************************************************************************************************/	
	#elif mode_of_CTC==Set
	
	TCCR0_ITI &=~ (1<<COM00_ITI);
	TCCR0_ITI |=  (1<<COM01_ITI);
	#endif
/***********************************************************************************************************************/

/************************************************ init to Fast PWM mode*************************************************/
	#elif mood_of_operation FastPWM
	
	TCCR0_ITI |= (1<<WGM00_ITI);
	TCCR0_ITI |= (1<<WGM01_ITI);


#endif
/***********************************************************************************************************************/
}



void Timer0_VoidTimer0PrescalerAdjusting()
{
/************************************************ set the prescaler 0 *************************************************/
	#if Prescaling ==Prescaler0
	TCCR0_ITI |=  (1<<CS00_ITI);
	TCCR0_ITI &=~ (1<<CS01_ITI);
	TCCR0_ITI &=~ (1<<CS02_ITI);
/***********************************************************************************************************************/

/************************************************ set the prescaler 8 *************************************************/
												 
	#elif Prescaling ==Prescaler8	
	TCCR0_ITI &=~ (1<<CS00_ITI);
	TCCR0_ITI |=  (1<<CS01_ITI);
	TCCR0_ITI &=~ (1<<CS02_ITI);
/***********************************************************************************************************************/	
			  
/************************************************ set the prescaler 64 *************************************************/
	#elif Prescaling ==Prescaler64			
	TCCR0_ITI |=  (1<<CS00_ITI);
	TCCR0_ITI |=  (1<<CS01_ITI);
	TCCR0_ITI &=~ (1<<CS02_ITI);	
/***********************************************************************************************************************/
 
/************************************************ set the prescaler 256 ************************************************/
	#elif Prescaling ==Prescaler256	
	TCCR0_ITI &=~ (1<<CS00_ITI);
	TCCR0_ITI &=~ (1<<CS01_ITI);
	TCCR0_ITI |=  (1<<CS02_ITI);		
/***********************************************************************************************************************/
		  
/************************************************ set the prescaler 1024 ***********************************************/
	#elif Prescaling ==Prescaler1024
	TCCR0_ITI |=  (1<<CS00_ITI);
	TCCR0_ITI &=~ (1<<CS01_ITI);
	TCCR0_ITI |=  (1<<CS02_ITI);
/***********************************************************************************************************************/
	#endif
}

void Timer0_VoidTimer0Flag()
{
/*******************************************set the registers to flag on copare match***********************************/
	#if   InterruptionType == FlagCTC
	TIFR_ITI |=(1<<OCF0_ITI);
/***********************************************************************************************************************/
	
/*******************************************set the registers to flag on over flow**************************************/
	#elif InterruptionType == FlagOF
	TIFR_ITI |=(1<<TOV0_ITI);
/***********************************************************************************************************************/

/***************************************set the registers to interrupt on compare match*********************************/
	#elif InterruptionType == InterruptCTC
	TIMSK_ITI|=(1<<OCIE0_ITI);
/***********************************************************************************************************************/

/***************************************set the registers to interrupt on over flow*************************************/
	#elif InterruptionType == InterruptOF
	TIMSK_ITI|=(1<<TOIE0_ITI);
/***********************************************************************************************************************/
#endif
}
void Timer0_VoidTimer0Start()
{
	Timer0_VoidTimer0SettingAdjust();
	Timer0_VoidTimer0Flag();
	Timer0_VoidTimer0PrescalerAdjusting();
	
}

void Timer0_VoidTimer0Preload()
{
	TCNT0_ITI=preload;
}

void Timer0_VoidTimer0Stop()
{
	TCCR0_ITI &=~ (1<<CS00_ITI);
	TCCR0_ITI &=~ (1<<CS01_ITI);
	TCCR0_ITI &=~ (1<<CS02_ITI);
} 